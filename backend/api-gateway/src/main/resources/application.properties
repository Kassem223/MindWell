# ==============================================================================
# 1. Core Server & Application Setup
# ==============================================================================
server.port=8080
spring.application.name=API-GATEWAY

# ==============================================================================
# 2. Eureka Client Configuration
# ==============================================================================
eureka.client.serviceUrl.defaultZone=http://localhost:8761/eureka/

# ==============================================================================
# 3. JWT Secret Key (for the AuthenticationFilter.java)
# ==============================================================================
# IMPORTANT: This MUST match the secret key used in your Auth Service!
jwt.secret.key=This_Is_The_Final_Shared_Secret_Key_For_MindWell_2025_PROJECT_XYZ

# ==============================================================================
# 4. Spring Cloud Gateway Routing
# Routes are defined using indexed arrays [0], [1], etc.
# ==============================================================================

# ------------------------------------------------------------------------------
# Route [0]: AUTH-SERVICE (Public / Unprotected)
# ------------------------------------------------------------------------------
spring.cloud.gateway.routes[0].id=auth-service
# Use Load Balancer (lb) and Service Name (AUTH-SERVICE)
spring.cloud.gateway.routes[0].uri=lb://AUTH-SERVICE
spring.cloud.gateway.routes[0].predicates[0]=Path=/api/auth/**
# Strip the first two path segments (/api/auth)
#spring.cloud.gateway.routes[0].filters[0]=StripPrefix=2


# ------------------------------------------------------------------------------
# Route [1]: MOOD-SERVICE (Protected / Filtered)
# ------------------------------------------------------------------------------
spring.cloud.gateway.routes[1].id=mood-service
# Use Load Balancer (lb) and Service Name (MOOD-SERVICE)
spring.cloud.gateway.routes[1].uri=lb://MOOD-SERVICE
spring.cloud.gateway.routes[1].predicates[0]=Path=/api/mood/**
# Apply the custom filter first
spring.cloud.gateway.routes[1].filters[0]=AuthenticationFilter
# Then, strip the first two path segments (/api/mood)
#spring.cloud.gateway.routes[1].filters[1]=StripPrefix=1
spring.cloud.gateway.routes[2].id=admin-service
spring.cloud.gateway.routes[2].uri=lb://ADMIN-SERVICE
spring.cloud.gateway.routes[2].predicates[0]=Path=/api/admin/**
spring.cloud.gateway.routes[2].filters[0]=AuthenticationFilter
#spring.cloud.gateway.routes[2].filters[1]=StripPrefix=1
