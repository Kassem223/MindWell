<app-navbar></app-navbar>

<div class="admin-dashboard">
  <div class="container">
    <div class="page-header">
      <h1>Admin Dashboard</h1>
      <p>Manage your MindWell platform</p>
    </div>

    <div class="stats-grid">
      <div class="stat-card card">
        <h3>Total Users</h3>
        <div class="stat-value">{{ stats.totalUsers }}</div>
        <span class="stat-change">+12% from last month</span>
      </div>

      <div class="stat-card card">
        <h3>Total Mood Entries</h3>
        <div class="stat-value">{{ stats.totalMoodEntries }}</div>
        <span class="stat-change">+8% from last month</span>
      </div>

      <div class="stat-card card">
        <h3>Total Tips</h3>
        <div class="stat-value">{{ stats.totalTips }}</div>
        <span class="stat-change">Active</span>
      </div>

      <div class="stat-card card">
        <h3>Total Psychologists</h3>
        <div class="stat-value">{{ stats.totalPsychologists }}</div>
        <span class="stat-change">All active</span>
      </div>
    </div>

    <div class="users-section card">
      <h2>Users</h2>
      <div class="users-table">
        @if (users.length > 0) {
        <table>
          <thead>
            <tr>
              <th>Name</th>
              <th>Email</th>
              <th>Roles</th>
              <th>Created At</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            @for (user of users; track user.id) {
            <tr>
              <td>{{ user.name }}</td>
              <td>{{ user.email }}</td>
              <td>
                <span class="role-badge" *ngFor="let role of user.roles">
                  {{ role }}
                </span>
              </td>
              <td>{{ user.createdAt | date: 'short' }}</td>
              <td class="actions-cell">
                <button class="btn-icon edit" (click)="startEdit(user)" title="Edit">‚úèÔ∏è</button>
                <button class="btn-icon delete" (click)="deleteUser(user.id)" title="Delete">üóëÔ∏è</button>
              </td>
            </tr>
            }
          </tbody>
        </table>
        } @else {
        <p class="no-data">No users found</p>
        }
      </div>
    </div>

    <!-- Edit User Modal -->
    @if (editingUser) {
    <div class="modal-overlay">
      <div class="modal-content card">
        <h3>Edit User</h3>
        <form (ngSubmit)="saveEdit()">
          <div class="form-group">
            <label>Name</label>
            <input [(ngModel)]="editForm.name" name="name" class="form-control" required>
          </div>
          <div class="form-group">
            <label>Email</label>
            <input [(ngModel)]="editForm.email" name="email" class="form-control" required>
          </div>
          <div class="modal-actions">
            <button type="button" class="btn-secondary" (click)="cancelEdit()">Cancel</button>
            <button type="submit" class="btn-primary">Save Changes</button>
          </div>
        </form>
      </div>
    </div>
    }

    <div class="recent-activity card">
      <h2>Recent Activity</h2>
      <div class="activity-list">
        @for (activity of recentActivity; track activity.message) {
        <div class="activity-item">
          <div class="activity-icon">{{ activity.type === 'user' ? 'üë§' : 'üòä' }}</div>
          <div class="activity-content">
            <p>{{ activity.message }}</p>
            <span class="activity-time">{{ activity.time }}</span>
          </div>
        </div>
        }
      </div>
    </div>
  </div>
</div>

<app-footer></app-footer>